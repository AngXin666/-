# æ·»åŠ æ–°é¡µé¢ç±»å‹æŒ‡å—ï¼ˆGUIé›†æˆç‰ˆï¼‰

## æ¦‚è¿°

ç°åœ¨æ·»åŠ æ–°é¡µé¢ç±»å‹éå¸¸ç®€å•ï¼ç³»ç»Ÿå·²ç»å°†**è‡ªåŠ¨æ³¨å†ŒåŠŸèƒ½é›†æˆåˆ°ä¸»ç¨‹åºGUI**ä¸­ï¼Œåªéœ€ç‚¹å‡»æŒ‰é’®å³å¯ã€‚

## å¿«é€Ÿå¼€å§‹ï¼ˆæ¨èï¼‰

1. **åœ¨æ ‡æ³¨å·¥å…·ä¸­æ·»åŠ æ–°ç±»å‹å¹¶è®­ç»ƒ**
2. **å¤åˆ¶æ¨¡å‹æ–‡ä»¶åˆ°ä¸»ç¨‹åº**
3. **ç‚¹å‡»ä¸»ç¨‹åºçš„"ğŸ”„ æ³¨å†Œæ–°æ¨¡å‹"æŒ‰é’®**
4. **å¤åˆ¶æç¤ºçš„ä»£ç åˆ° `src/page_detector.py`**
5. **é‡å¯ç¨‹åº**

å°±è¿™ä¹ˆç®€å•ï¼

---

## è¯¦ç»†æ­¥éª¤

### æ­¥éª¤1ï¼šåœ¨æ ‡æ³¨å·¥å…·ä¸­æ·»åŠ æ–°ç±»å‹

1. æ‰“å¼€æ ‡æ³¨å·¥å…·çš„ `training_data/` ç›®å½•
2. åˆ›å»ºæ–°çš„ç±»å‹æ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚ï¼š`æ¶ˆæ¯é¡µ/`
3. å°†è¯¥ç±»å‹çš„æˆªå›¾æ”¾å…¥æ–‡ä»¶å¤¹
4. è®­ç»ƒæ¨¡å‹

**ç¤ºä¾‹ï¼š**
```
æ ‡æ³¨å·¥å…·_å®Œæ•´ç‹¬ç«‹ç‰ˆ/training_data/
â”œâ”€â”€ ç™»å½•é¡µ/
â”œâ”€â”€ é¦–é¡µ/
â””â”€â”€ æ¶ˆæ¯é¡µ/  â† æ–°å»ºæ–‡ä»¶å¤¹
    â”œâ”€â”€ screenshot1.png
    â””â”€â”€ screenshot2.png
```

### æ­¥éª¤2ï¼šå¤åˆ¶æ¨¡å‹æ–‡ä»¶

å°†è®­ç»ƒå¥½çš„æ¨¡å‹æ–‡ä»¶å¤åˆ¶åˆ°ä¸»ç¨‹åºï¼š

```bash
æ ‡æ³¨å·¥å…·_å®Œæ•´ç‹¬ç«‹ç‰ˆ/models/page_classifier_pytorch_best.pth  â†’ models/
æ ‡æ³¨å·¥å…·_å®Œæ•´ç‹¬ç«‹ç‰ˆ/models/page_classes.json                  â†’ models/
æ ‡æ³¨å·¥å…·_å®Œæ•´ç‹¬ç«‹ç‰ˆ/models/model_version.json                 â†’ models/
```

### æ­¥éª¤3ï¼šç‚¹å‡»"æ³¨å†Œæ–°æ¨¡å‹"æŒ‰é’®

åœ¨ä¸»ç¨‹åºGUIä¸­ï¼Œç‚¹å‡»é¡¶éƒ¨çš„ **"ğŸ”„ æ³¨å†Œæ–°æ¨¡å‹"** æŒ‰é’®ã€‚

ç¨‹åºä¼šè‡ªåŠ¨ï¼š
- âœ… æ‰«ææ–°çš„YOLOæ¨¡å‹
- âœ… æ‰«ææ–°çš„é¡µé¢ç±»å‹
- âœ… è‡ªåŠ¨ç”Ÿæˆé…ç½®
- âœ… æ›´æ–°é…ç½®æ–‡ä»¶
- âœ… æ˜¾ç¤ºéœ€è¦æ·»åŠ çš„ä»£ç 

**ç¤ºä¾‹è¾“å‡ºï¼š**
```
================================================================================
ğŸ” æ­£åœ¨æ‰«ææ–°æ¨¡å‹å’Œæ–°é¡µé¢ç±»å‹...
================================================================================

ğŸ“¦ æ­¥éª¤1: æ‰«æYOLOæ¨¡å‹...
âœ… æœªå‘ç°æ–°æ¨¡å‹

ğŸ“¦ æ­¥éª¤2: æ‰«æé¡µé¢ç±»å‹...
å‘ç° 1 ä¸ªæ–°é¡µé¢ç±»å‹:
  - æ¶ˆæ¯é¡µ
æ­£åœ¨è‡ªåŠ¨æ³¨å†Œ...
âœ… æˆåŠŸæ³¨å†Œ 1 ä¸ªé¡µé¢ç±»å‹
ğŸ“ é…ç½®å·²æ›´æ–°: config/page_state_mapping.json

================================================================================
ğŸ“Š æ³¨å†Œç»“æœæ±‡æ€»
================================================================================
âœ… YOLOæ¨¡å‹: æœªå‘ç°æ–°æ¨¡å‹
âœ… é¡µé¢ç±»å‹: æˆåŠŸæ³¨å†Œ 1 ä¸ª
   æ–°ç±»å‹: æ¶ˆæ¯é¡µ

================================================================================
âš ï¸  é‡è¦æç¤ºï¼šéœ€è¦æ‰‹åŠ¨æ·»åŠ  PageState æšä¸¾
================================================================================

# éœ€è¦åœ¨ src/page_detector.py ä¸­æ·»åŠ ä»¥ä¸‹æšä¸¾ï¼š

class PageState(Enum):
    # ... ç°æœ‰çš„æšä¸¾ ...

    MESSAGE_PAGE = "message_page"  # æ¶ˆæ¯é¡µ

    @property
    def chinese_name(self) -> str:
        name_map = {
            # ... ç°æœ‰çš„æ˜ å°„ ...
            "message_page": "æ¶ˆæ¯é¡µ",
        }
        return name_map.get(self.value, self.value)

ğŸ’¡ æç¤º: è¯·å¤åˆ¶ä¸Šè¿°ä»£ç åˆ° src/page_detector.py æ–‡ä»¶ä¸­

================================================================================
ğŸ‰ æ€»è®¡æ³¨å†Œ: 1 é¡¹

ğŸ’¡ æç¤ºï¼š
  â€¢ é¡µé¢ç±»å‹éœ€è¦æ·»åŠ æšä¸¾ä»£ç åé‡å¯ç”Ÿæ•ˆ
================================================================================
```

### æ­¥éª¤4ï¼šæ·»åŠ  PageState æšä¸¾

æ ¹æ®GUIè¾“å‡ºçš„ä»£ç ï¼Œæ‰“å¼€ `src/page_detector.py` æ–‡ä»¶ï¼Œå¤åˆ¶ç²˜è´´ä»£ç ï¼š

```python
class PageState(Enum):
    # ... ç°æœ‰çš„æšä¸¾ ...
    
    # æ·»åŠ æ–°é¡µé¢ç±»å‹ï¼ˆä»GUIå¤åˆ¶ï¼‰
    MESSAGE_PAGE = "message_page"  # æ¶ˆæ¯é¡µ
    
    @property
    def chinese_name(self) -> str:
        name_map = {
            # ... ç°æœ‰çš„æ˜ å°„ ...
            "message_page": "æ¶ˆæ¯é¡µ",  # ä»GUIå¤åˆ¶
        }
        return name_map.get(self.value, self.value)
```

### æ­¥éª¤5ï¼šé‡å¯ç¨‹åº

é‡å¯ä¸»ç¨‹åºï¼Œæ–°çš„é¡µé¢ç±»å‹å°±å¯ä»¥è¢«è¯†åˆ«äº†ï¼

---

## è‡ªåŠ¨æ£€æµ‹åŠŸèƒ½

ä¸»ç¨‹åºå¯åŠ¨æ—¶ä¼š**è‡ªåŠ¨æ£€æµ‹**æ–°æ¨¡å‹å’Œæ–°é¡µé¢ç±»å‹ï¼š

- å¦‚æœå‘ç°æ–°å†…å®¹ï¼Œä¼šåœ¨æ—¥å¿—åŒºåŸŸæ˜¾ç¤ºé€šçŸ¥
- è‡ªåŠ¨æ³¨å†ŒYOLOæ¨¡å‹å’Œé¡µé¢ç±»å‹
- æç¤ºéœ€è¦æ·»åŠ çš„æšä¸¾ä»£ç 

**ç¤ºä¾‹é€šçŸ¥ï¼š**
```
================================================================================
ğŸ‰ è‡ªåŠ¨æ³¨å†Œå®Œæˆ
================================================================================
âœ… YOLOæ¨¡å‹: 2 ä¸ª
   ç‰ˆæœ¬: 1.0.6
âœ… é¡µé¢ç±»å‹: 1 ä¸ª
   æ–°ç±»å‹: æ¶ˆæ¯é¡µ

âš ï¸  æç¤º: æ–°é¡µé¢ç±»å‹éœ€è¦æ·»åŠ  PageState æšä¸¾
   è¯·ç‚¹å‡» 'ğŸ”„ æ³¨å†Œæ–°æ¨¡å‹' æŒ‰é’®æŸ¥çœ‹è¯¦ç»†ä»£ç 
================================================================================
```

---

## é…ç½®æ–‡ä»¶è¯´æ˜

### config/page_state_mapping.json

è¿™æ˜¯é¡µé¢çŠ¶æ€æ˜ å°„çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œç”±GUIè‡ªåŠ¨ç®¡ç†ï¼š

```json
{
  "version": "1.0.0",
  "description": "é¡µé¢ç±»å‹åˆ°PageStateçš„æ˜ å°„é…ç½®",
  "mappings": {
    "æ¶ˆæ¯é¡µ": {
      "state": "MESSAGE_PAGE",
      "state_value": "message_page",
      "chinese_name": "æ¶ˆæ¯é¡µ",
      "description": "æ¶ˆæ¯é¡µï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰"
    }
  },
  "auto_register": {
    "enabled": true,
    "default_state": "UNKNOWN",
    "default_state_value": "unknown"
  }
}
```

**å­—æ®µè¯´æ˜ï¼š**
- `state`: PageState æšä¸¾åç§°ï¼ˆå¤§å†™+ä¸‹åˆ’çº¿ï¼‰
- `state_value`: PageState æšä¸¾å€¼ï¼ˆå°å†™+ä¸‹åˆ’çº¿ï¼‰
- `chinese_name`: ä¸­æ–‡æ˜¾ç¤ºåç§°
- `description`: æè¿°ä¿¡æ¯

**æ³¨æ„ï¼š** é€šå¸¸ä¸éœ€è¦æ‰‹åŠ¨ç¼–è¾‘æ­¤æ–‡ä»¶ï¼ŒGUIä¼šè‡ªåŠ¨ç®¡ç†ã€‚

---

## å‘½ä»¤è¡Œå·¥å…·ï¼ˆå¯é€‰ï¼‰

å¦‚æœä¸æƒ³ä½¿ç”¨GUIï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·ï¼š

```bash
python tools/auto_register_page_types.py
```

---

## ä¼˜åŠ¿å¯¹æ¯”

### æ—§æ–¹å¼ï¼ˆæ‰‹åŠ¨ä¿®æ”¹ä»£ç ï¼‰
- âŒ éœ€è¦ä¿®æ”¹ 2 ä¸ª Python æ–‡ä»¶
- âŒ å®¹æ˜“å‡ºé”™
- âŒ ä¸æ–¹ä¾¿ç»´æŠ¤
- âŒ éœ€è¦é‡æ–°ç†è§£ä»£ç ç»“æ„

### æ–°æ–¹å¼ï¼ˆGUIé›†æˆï¼‰
- âœ… åªéœ€ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®
- âœ… è‡ªåŠ¨æ‰«æå’Œæ³¨å†Œ
- âœ… è‡ªåŠ¨ç”Ÿæˆä»£ç æç¤º
- âœ… è‡ªåŠ¨å¤‡ä»½é…ç½®æ–‡ä»¶
- âœ… å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹
- âœ… æ¸…æ™°çš„æ—¥å¿—è¾“å‡º
- âœ… å‘åå…¼å®¹

---

## æ³¨æ„äº‹é¡¹

1. **ç±»åˆ«åç§°ä¸€è‡´æ€§**ï¼š
   - `training_data/` æ–‡ä»¶å¤¹å
   - `page_classes.json` ä¸­çš„åç§°
   - `page_state_mapping.json` ä¸­çš„é”®
   - è¿™ä¸‰è€…å¿…é¡»å®Œå…¨ä¸€è‡´

2. **PageState æšä¸¾ä»éœ€æ‰‹åŠ¨æ·»åŠ **ï¼š
   - é…ç½®æ–‡ä»¶åªæ˜¯æ˜ å°„å…³ç³»
   - PageState æšä¸¾æ˜¯ Python ä»£ç ï¼Œå¿…é¡»æ‰‹åŠ¨æ·»åŠ 
   - GUIä¼šè‡ªåŠ¨ç”Ÿæˆéœ€è¦æ·»åŠ çš„ä»£ç ï¼Œåªéœ€å¤åˆ¶ç²˜è´´

3. **è‡ªåŠ¨ç”Ÿæˆçš„çŠ¶æ€åç§°**ï¼š
   - GUIè‡ªåŠ¨ç”Ÿæˆçš„çŠ¶æ€åç§°å¯èƒ½ä¸å¤Ÿå‡†ç¡®
   - å¦‚æœä¸æ»¡æ„ï¼Œå¯ä»¥æ‰‹åŠ¨ç¼–è¾‘ `config/page_state_mapping.json`
   - ç¡®ä¿ä¸ PageState æšä¸¾ä¸­çš„å®šä¹‰ä¸€è‡´

4. **é…ç½®æ–‡ä»¶å¤‡ä»½**ï¼š
   - GUIä¼šè‡ªåŠ¨å¤‡ä»½åŸé…ç½®æ–‡ä»¶
   - å¤‡ä»½æ–‡ä»¶æ ¼å¼ï¼š`page_state_mapping.json.backup_æ—¶é—´æˆ³`
   - å¦‚æœå‡ºé”™å¯ä»¥æ¢å¤

---

## å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆè¿˜éœ€è¦æ‰‹åŠ¨æ·»åŠ  PageState æšä¸¾ï¼Ÿ**
A: 
- Python çš„æšä¸¾ç±»å‹æ˜¯é™æ€çš„ï¼Œä¸èƒ½åŠ¨æ€æ·»åŠ 
- æšä¸¾æä¾›äº†ç±»å‹å®‰å…¨å’Œä»£ç æç¤º
- é…ç½®æ–‡ä»¶åªè´Ÿè´£æ˜ å°„å…³ç³»ï¼Œä¸èƒ½æ›¿ä»£æšä¸¾å®šä¹‰
- ä½†GUIä¼šè‡ªåŠ¨ç”Ÿæˆä»£ç ï¼Œåªéœ€å¤åˆ¶ç²˜è´´å³å¯

**Q: å¦‚æœä¸æ·»åŠ  PageState æšä¸¾ä¼šæ€æ ·ï¼Ÿ**
A: 
- ç¨‹åºå¯åŠ¨æ—¶ä¼šæŠ¥é”™ï¼šæ‰¾ä¸åˆ°å¯¹åº”çš„ PageState
- éœ€è¦ç¡®ä¿é…ç½®æ–‡ä»¶ä¸­çš„ `state_value` åœ¨ PageState æšä¸¾ä¸­å­˜åœ¨

**Q: GUIç”Ÿæˆçš„çŠ¶æ€åç§°ä¸æ»¡æ„æ€ä¹ˆåŠï¼Ÿ**
A: 
- å¯ä»¥æ‰‹åŠ¨ç¼–è¾‘ `config/page_state_mapping.json`
- ä¿®æ”¹ `state` å’Œ `state_value` å­—æ®µ
- ç¡®ä¿ä¸ PageState æšä¸¾ä¸­çš„å®šä¹‰ä¸€è‡´
- æˆ–è€…å†æ¬¡ç‚¹å‡»"æ³¨å†Œæ–°æ¨¡å‹"æŒ‰é’®é‡æ–°ç”Ÿæˆ

**Q: å¦‚ä½•éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ï¼Ÿ**
A: 
1. å¯åŠ¨ä¸»ç¨‹åºï¼ŒæŸ¥çœ‹æ—¥å¿—
2. åº”è¯¥æ˜¾ç¤ºï¼š`âœ“ å·²åŠ è½½ X ä¸ªé¡µé¢çŠ¶æ€æ˜ å°„`
3. å¯¼èˆªåˆ°æ–°é¡µé¢ï¼Œæ£€æŸ¥è¯†åˆ«ç»“æœ
4. ä¸åº”è¯¥æ˜¾ç¤º `UNKNOWN` æˆ–é”™è¯¯ä¿¡æ¯

**Q: å¯ä»¥æ‰¹é‡æ·»åŠ å¤šä¸ªé¡µé¢ç±»å‹å—ï¼Ÿ**
A: 
- å¯ä»¥ï¼åœ¨æ ‡æ³¨å·¥å…·ä¸­æ·»åŠ å¤šä¸ªæ–°ç±»å‹æ–‡ä»¶å¤¹
- è®­ç»ƒåå¤åˆ¶æ¨¡å‹æ–‡ä»¶
- ç‚¹å‡»"æ³¨å†Œæ–°æ¨¡å‹"æŒ‰é’®ï¼Œä¼šä¸€æ¬¡æ€§æ³¨å†Œæ‰€æœ‰æ–°ç±»å‹
- GUIä¼šæ˜¾ç¤ºæ‰€æœ‰éœ€è¦æ·»åŠ çš„æšä¸¾ä»£ç 

---

## å®Œæ•´ç¤ºä¾‹

å‡è®¾è¦æ·»åŠ "æ¶ˆæ¯é¡µ"å’Œ"é€šçŸ¥é¡µ"ï¼š

### 1. æ ‡æ³¨å·¥å…·
```
training_data/
â”œâ”€â”€ æ¶ˆæ¯é¡µ/
â”‚   â”œâ”€â”€ msg1.png
â”‚   â””â”€â”€ msg2.png
â””â”€â”€ é€šçŸ¥é¡µ/
    â”œâ”€â”€ notify1.png
    â””â”€â”€ notify2.png
```

### 2. è®­ç»ƒå¹¶å¤åˆ¶æ¨¡å‹æ–‡ä»¶

### 3. ç‚¹å‡»"æ³¨å†Œæ–°æ¨¡å‹"æŒ‰é’®

GUIä¼šæ˜¾ç¤ºï¼š
```
å‘ç° 2 ä¸ªæ–°é¡µé¢ç±»å‹:
  - æ¶ˆæ¯é¡µ
  - é€šçŸ¥é¡µ

âœ… æˆåŠŸæ³¨å†Œ 2 ä¸ªé¡µé¢ç±»å‹

éœ€è¦æ·»åŠ çš„ä»£ç ï¼š
    MESSAGE_PAGE = "message_page"  # æ¶ˆæ¯é¡µ
    NOTIFICATION_PAGE = "notification_page"  # é€šçŸ¥é¡µ
```

### 4. å¤åˆ¶ä»£ç åˆ° src/page_detector.py

### 5. é‡å¯ç¨‹åº

å®Œæˆï¼ä¸¤ä¸ªæ–°é¡µé¢ç±»å‹éƒ½å¯ä»¥æ­£å¸¸è¯†åˆ«äº†ã€‚

---

## æ€»ç»“

ç°åœ¨æ·»åŠ æ–°é¡µé¢ç±»å‹åªéœ€è¦ï¼š
1. âœ… æ ‡æ³¨å·¥å…·ä¸­æ·»åŠ æ–°ç±»å‹
2. âœ… å¤åˆ¶æ¨¡å‹æ–‡ä»¶
3. âœ… ç‚¹å‡»GUIæŒ‰é’®
4. âœ… å¤åˆ¶ç²˜è´´ä»£ç 
5. âœ… é‡å¯ç¨‹åº

**ä¸éœ€è¦ï¼š**
- âŒ æ‰‹åŠ¨ç¼–è¾‘é…ç½®æ–‡ä»¶
- âŒ ç†è§£ä»£ç ç»“æ„
- âŒ æ‹…å¿ƒå‡ºé”™
- âŒ æ‰‹åŠ¨å¤‡ä»½

ä¸€åˆ‡éƒ½ç”±GUIè‡ªåŠ¨å¤„ç†ï¼

## æ¦‚è¿°

ç°åœ¨æ·»åŠ æ–°é¡µé¢ç±»å‹æ›´ç®€å•äº†ï¼ç³»ç»Ÿæ”¯æŒ**è‡ªåŠ¨æ³¨å†Œ**ï¼Œåªéœ€è¦ç®€å•é…ç½®å³å¯ã€‚

## å¿«é€Ÿå¼€å§‹

### æ–¹å¼1ï¼šè‡ªåŠ¨æ³¨å†Œï¼ˆæ¨èï¼‰

1. **åœ¨æ ‡æ³¨å·¥å…·ä¸­æ·»åŠ æ–°ç±»å‹å¹¶è®­ç»ƒ**
2. **å¤åˆ¶æ¨¡å‹æ–‡ä»¶åˆ°ä¸»ç¨‹åº**
3. **è¿è¡Œè‡ªåŠ¨æ³¨å†Œå·¥å…·**
4. **æ·»åŠ  PageState æšä¸¾**
5. **é‡å¯ç¨‹åº**

### æ–¹å¼2ï¼šæ‰‹åŠ¨é…ç½®

ç›´æ¥ç¼–è¾‘ `config/page_state_mapping.json` æ–‡ä»¶

---

## è¯¦ç»†æ­¥éª¤

### æ­¥éª¤1ï¼šåœ¨æ ‡æ³¨å·¥å…·ä¸­æ·»åŠ æ–°ç±»å‹

1. æ‰“å¼€æ ‡æ³¨å·¥å…·çš„ `training_data/` ç›®å½•
2. åˆ›å»ºæ–°çš„ç±»å‹æ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚ï¼š`æ¶ˆæ¯é¡µ/`
3. å°†è¯¥ç±»å‹çš„æˆªå›¾æ”¾å…¥æ–‡ä»¶å¤¹
4. è®­ç»ƒæ¨¡å‹

**ç¤ºä¾‹ï¼š**
```
æ ‡æ³¨å·¥å…·_å®Œæ•´ç‹¬ç«‹ç‰ˆ/training_data/
â”œâ”€â”€ ç™»å½•é¡µ/
â”œâ”€â”€ é¦–é¡µ/
â””â”€â”€ æ¶ˆæ¯é¡µ/  â† æ–°å»ºæ–‡ä»¶å¤¹
    â”œâ”€â”€ screenshot1.png
    â””â”€â”€ screenshot2.png
```

### æ­¥éª¤2ï¼šå¤åˆ¶æ¨¡å‹æ–‡ä»¶

å°†è®­ç»ƒå¥½çš„æ¨¡å‹æ–‡ä»¶å¤åˆ¶åˆ°ä¸»ç¨‹åºï¼š

```bash
æ ‡æ³¨å·¥å…·_å®Œæ•´ç‹¬ç«‹ç‰ˆ/models/page_classifier_pytorch_best.pth  â†’ models/
æ ‡æ³¨å·¥å…·_å®Œæ•´ç‹¬ç«‹ç‰ˆ/models/page_classes.json                  â†’ models/
æ ‡æ³¨å·¥å…·_å®Œæ•´ç‹¬ç«‹ç‰ˆ/models/model_version.json                 â†’ models/
```

### æ­¥éª¤3ï¼šè¿è¡Œè‡ªåŠ¨æ³¨å†Œå·¥å…·

```bash
python tools/auto_register_page_types.py
```

å·¥å…·ä¼šï¼š
- âœ… è‡ªåŠ¨æ‰«æ `page_classes.json` ä¸­çš„æ‰€æœ‰ç±»åˆ«
- âœ… æ£€æµ‹æœªæ˜ å°„çš„æ–°ç±»åˆ«
- âœ… è‡ªåŠ¨ç”Ÿæˆé…ç½®
- âœ… æ›´æ–° `config/page_state_mapping.json`

**ç¤ºä¾‹è¾“å‡ºï¼š**
```
ğŸ” è‡ªåŠ¨æ³¨å†Œæ–°é¡µé¢ç±»å‹
================================================================================

ğŸ“¦ åŠ è½½é¡µé¢ç±»åˆ«...
  âœ“ æ‰¾åˆ° 26 ä¸ªé¡µé¢ç±»åˆ«

ğŸ“¦ åŠ è½½çŠ¶æ€æ˜ å°„é…ç½®...
  âœ“ å·²æ˜ å°„ 25 ä¸ªç±»åˆ«

ğŸ” æ£€æŸ¥æœªæ˜ å°„çš„ç±»åˆ«...
  âš ï¸  å‘ç° 1 ä¸ªæœªæ˜ å°„çš„ç±»åˆ«:
    â€¢ æ¶ˆæ¯é¡µ

ğŸ”§ ç”Ÿæˆæ–°æ˜ å°„é…ç½®...
  â€¢ æ¶ˆæ¯é¡µ
    - STATE: MESSAGE_PAGE
    - state_value: message_page

æ˜¯å¦å°†æ–°æ˜ å°„æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ï¼Ÿ(y/n): y

âœ“ å·²å¤‡ä»½åŸé…ç½®: page_state_mapping.json.backup_20260207_120000
âœ“ å·²ä¿å­˜é…ç½®: config/page_state_mapping.json

âœ… å®Œæˆï¼
```

### æ­¥éª¤4ï¼šæ·»åŠ  PageState æšä¸¾

æ ¹æ®å·¥å…·è¾“å‡ºçš„æç¤ºï¼Œåœ¨ `src/page_detector.py` ä¸­æ·»åŠ æšä¸¾ï¼š

```python
class PageState(Enum):
    # ... ç°æœ‰çš„æšä¸¾ ...
    
    # æ·»åŠ æ–°é¡µé¢ç±»å‹
    MESSAGE_PAGE = "message_page"  # æ¶ˆæ¯é¡µ
    
    @property
    def chinese_name(self) -> str:
        name_map = {
            # ... ç°æœ‰çš„æ˜ å°„ ...
            "message_page": "æ¶ˆæ¯é¡µ",
        }
        return name_map.get(self.value, self.value)
```

### æ­¥éª¤5ï¼šé‡å¯ç¨‹åº

é‡å¯ä¸»ç¨‹åºï¼Œæ–°çš„é¡µé¢ç±»å‹å°±å¯ä»¥è¢«è¯†åˆ«äº†ï¼

---

## é…ç½®æ–‡ä»¶è¯´æ˜

### config/page_state_mapping.json

è¿™æ˜¯é¡µé¢çŠ¶æ€æ˜ å°„çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼š

```json
{
  "version": "1.0.0",
  "description": "é¡µé¢ç±»å‹åˆ°PageStateçš„æ˜ å°„é…ç½®",
  "mappings": {
    "æ¶ˆæ¯é¡µ": {
      "state": "MESSAGE_PAGE",
      "state_value": "message_page",
      "chinese_name": "æ¶ˆæ¯é¡µ",
      "description": "æ¶ˆæ¯é¡µé¢"
    }
  },
  "auto_register": {
    "enabled": true,
    "default_state": "UNKNOWN",
    "default_state_value": "unknown",
    "description": "æœªæ˜ å°„çš„ç±»åˆ«è‡ªåŠ¨æ³¨å†Œä¸ºUNKNOWNçŠ¶æ€"
  }
}
```

**å­—æ®µè¯´æ˜ï¼š**
- `state`: PageState æšä¸¾åç§°ï¼ˆå¤§å†™+ä¸‹åˆ’çº¿ï¼‰
- `state_value`: PageState æšä¸¾å€¼ï¼ˆå°å†™+ä¸‹åˆ’çº¿ï¼‰
- `chinese_name`: ä¸­æ–‡æ˜¾ç¤ºåç§°
- `description`: æè¿°ä¿¡æ¯

---

## æ‰‹åŠ¨é…ç½®æ–¹å¼

å¦‚æœä¸æƒ³ä½¿ç”¨è‡ªåŠ¨å·¥å…·ï¼Œå¯ä»¥æ‰‹åŠ¨ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š

### 1. ç¼–è¾‘ config/page_state_mapping.json

æ·»åŠ æ–°çš„æ˜ å°„ï¼š

```json
{
  "mappings": {
    "æ–°é¡µé¢ç±»å‹": {
      "state": "NEW_PAGE",
      "state_value": "new_page",
      "chinese_name": "æ–°é¡µé¢ç±»å‹",
      "description": "æ–°é¡µé¢çš„æè¿°"
    }
  }
}
```

### 2. æ·»åŠ  PageState æšä¸¾

åœ¨ `src/page_detector.py` ä¸­æ·»åŠ ï¼š

```python
class PageState(Enum):
    NEW_PAGE = "new_page"  # æ–°é¡µé¢ç±»å‹
    
    @property
    def chinese_name(self) -> str:
        name_map = {
            "new_page": "æ–°é¡µé¢ç±»å‹",
        }
```

---

## ä¼˜åŠ¿å¯¹æ¯”

### æ—§æ–¹å¼ï¼ˆæ‰‹åŠ¨ä¿®æ”¹ä»£ç ï¼‰
- âŒ éœ€è¦ä¿®æ”¹ 2 ä¸ª Python æ–‡ä»¶
- âŒ å®¹æ˜“å‡ºé”™
- âŒ ä¸æ–¹ä¾¿ç»´æŠ¤
- âŒ éœ€è¦é‡æ–°ç†è§£ä»£ç ç»“æ„

### æ–°æ–¹å¼ï¼ˆé…ç½®æ–‡ä»¶ï¼‰
- âœ… åªéœ€ç¼–è¾‘ 1 ä¸ªé…ç½®æ–‡ä»¶
- âœ… æ”¯æŒè‡ªåŠ¨æ³¨å†Œå·¥å…·
- âœ… é…ç½®æ–‡ä»¶æ˜“äºç†è§£
- âœ… è‡ªåŠ¨å¤‡ä»½ï¼Œå®‰å…¨å¯é 
- âœ… å‘åå…¼å®¹ï¼ˆé…ç½®æ–‡ä»¶ä¸å­˜åœ¨æ—¶ä½¿ç”¨é»˜è®¤æ˜ å°„ï¼‰

---

## æ³¨æ„äº‹é¡¹

1. **ç±»åˆ«åç§°ä¸€è‡´æ€§**ï¼š
   - `training_data/` æ–‡ä»¶å¤¹å
   - `page_classes.json` ä¸­çš„åç§°
   - `page_state_mapping.json` ä¸­çš„é”®
   - è¿™ä¸‰è€…å¿…é¡»å®Œå…¨ä¸€è‡´

2. **PageState æšä¸¾ä»éœ€æ‰‹åŠ¨æ·»åŠ **ï¼š
   - é…ç½®æ–‡ä»¶åªæ˜¯æ˜ å°„å…³ç³»
   - PageState æšä¸¾æ˜¯ Python ä»£ç ï¼Œå¿…é¡»æ‰‹åŠ¨æ·»åŠ 
   - è‡ªåŠ¨å·¥å…·ä¼šæç¤ºéœ€è¦æ·»åŠ çš„ä»£ç 

3. **è‡ªåŠ¨ç”Ÿæˆçš„çŠ¶æ€åç§°**ï¼š
   - è‡ªåŠ¨å·¥å…·ç”Ÿæˆçš„çŠ¶æ€åç§°å¯èƒ½ä¸å¤Ÿå‡†ç¡®
   - å»ºè®®æ£€æŸ¥å¹¶æ‰‹åŠ¨è°ƒæ•´
   - ç‰¹åˆ«æ˜¯å¤æ‚çš„é¡µé¢åç§°

4. **é…ç½®æ–‡ä»¶å¤‡ä»½**ï¼š
   - è‡ªåŠ¨å·¥å…·ä¼šå¤‡ä»½åŸé…ç½®æ–‡ä»¶
   - å¤‡ä»½æ–‡ä»¶æ ¼å¼ï¼š`page_state_mapping.json.backup_æ—¶é—´æˆ³`
   - å¦‚æœå‡ºé”™å¯ä»¥æ¢å¤

---

## å¸¸è§é—®é¢˜

**Q: ä¸ºä»€ä¹ˆè¿˜éœ€è¦æ‰‹åŠ¨æ·»åŠ  PageState æšä¸¾ï¼Ÿ**
A: 
- Python çš„æšä¸¾ç±»å‹æ˜¯é™æ€çš„ï¼Œä¸èƒ½åŠ¨æ€æ·»åŠ 
- æšä¸¾æä¾›äº†ç±»å‹å®‰å…¨å’Œä»£ç æç¤º
- é…ç½®æ–‡ä»¶åªè´Ÿè´£æ˜ å°„å…³ç³»ï¼Œä¸èƒ½æ›¿ä»£æšä¸¾å®šä¹‰

**Q: å¦‚æœä¸æ·»åŠ  PageState æšä¸¾ä¼šæ€æ ·ï¼Ÿ**
A: 
- ç¨‹åºå¯åŠ¨æ—¶ä¼šæŠ¥é”™ï¼šæ‰¾ä¸åˆ°å¯¹åº”çš„ PageState
- éœ€è¦ç¡®ä¿é…ç½®æ–‡ä»¶ä¸­çš„ `state_value` åœ¨ PageState æšä¸¾ä¸­å­˜åœ¨

**Q: å¯ä»¥åªç”¨é…ç½®æ–‡ä»¶ï¼Œä¸ç”¨æšä¸¾å—ï¼Ÿ**
A: 
- ä¸å¯ä»¥ï¼Œæšä¸¾æ˜¯å¿…éœ€çš„
- æšä¸¾æä¾›äº†ç±»å‹æ£€æŸ¥å’Œä»£ç æç¤º
- é…ç½®æ–‡ä»¶åªæ˜¯ç®€åŒ–äº†æ˜ å°„å…³ç³»çš„ç»´æŠ¤

**Q: è‡ªåŠ¨å·¥å…·ç”Ÿæˆçš„çŠ¶æ€åç§°ä¸æ»¡æ„æ€ä¹ˆåŠï¼Ÿ**
A: 
- å¯ä»¥æ‰‹åŠ¨ç¼–è¾‘ `config/page_state_mapping.json`
- ä¿®æ”¹ `state` å’Œ `state_value` å­—æ®µ
- ç¡®ä¿ä¸ PageState æšä¸¾ä¸­çš„å®šä¹‰ä¸€è‡´

**Q: å¦‚ä½•éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ï¼Ÿ**
A: 
1. å¯åŠ¨ä¸»ç¨‹åºï¼ŒæŸ¥çœ‹æ—¥å¿—
2. åº”è¯¥æ˜¾ç¤ºï¼š`âœ“ å·²åŠ è½½ X ä¸ªé¡µé¢çŠ¶æ€æ˜ å°„`
3. å¯¼èˆªåˆ°æ–°é¡µé¢ï¼Œæ£€æŸ¥è¯†åˆ«ç»“æœ
4. ä¸åº”è¯¥æ˜¾ç¤º `UNKNOWN` æˆ–é”™è¯¯ä¿¡æ¯

---

## å®Œæ•´ç¤ºä¾‹

å‡è®¾è¦æ·»åŠ "æ¶ˆæ¯é¡µ"å’Œ"é€šçŸ¥é¡µ"ï¼š

### 1. æ ‡æ³¨å·¥å…·
```
training_data/
â”œâ”€â”€ æ¶ˆæ¯é¡µ/
â”‚   â”œâ”€â”€ msg1.png
â”‚   â””â”€â”€ msg2.png
â””â”€â”€ é€šçŸ¥é¡µ/
    â”œâ”€â”€ notify1.png
    â””â”€â”€ notify2.png
```

### 2. è®­ç»ƒå¹¶å¤åˆ¶æ¨¡å‹æ–‡ä»¶

### 3. è¿è¡Œè‡ªåŠ¨æ³¨å†Œ
```bash
python tools/auto_register_page_types.py
```

### 4. æ·»åŠ  PageState æšä¸¾
```python
# src/page_detector.py
class PageState(Enum):
    # ... ç°æœ‰çš„ ...
    MESSAGE_PAGE = "message_page"  # æ¶ˆæ¯é¡µ
    NOTIFICATION_PAGE = "notification_page"  # é€šçŸ¥é¡µ
    
    @property
    def chinese_name(self) -> str:
        name_map = {
            # ... ç°æœ‰çš„ ...
            "message_page": "æ¶ˆæ¯é¡µ",
            "notification_page": "é€šçŸ¥é¡µ",
        }
```

### 5. é‡å¯ç¨‹åº

å®Œæˆï¼æ–°é¡µé¢ç±»å‹å·²ç»å¯ä»¥æ­£å¸¸è¯†åˆ«äº†ã€‚
